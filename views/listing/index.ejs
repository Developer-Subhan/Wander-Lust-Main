<% layout("layouts/boilerplate") %>
    <style>
        #filters {
            display: flex;
            flex-wrap: nowrap;
            /* no wrap so items stay in one line */
            overflow-x: auto;
            /* enable horizontal scroll */
            scrollbar-width: none;
            /* hide scrollbar (Firefox) */
            -ms-overflow-style: none;
            /* hide scrollbar (IE/Edge) */
            padding: 0.5rem 0;
            align-items: center;
            width: auto;
        }

        #filters::-webkit-scrollbar {
            display: none;
            /* hide scrollbar (Chrome/Safari) */
        }

        .filter {
            flex: 0 0 auto;
            /* prevent shrinking */
            text-align: center;
            margin-right: 2rem;
            opacity: 0.7;
        }

        .filter:hover {
            opacity: 1;
            cursor: pointer;
        }

        .tax-info {
            display: none;
        }

        .tax-toggle {
            border: 1px solid black;
            border-radius: 1.5rem;
            height: auto;
            width: auto;
            padding: 1rem;
            margin-left: auto;
        }
    </style>
    <!-- Page Header -->
    <div id="filters">
        <div class="filter mt-3">
            <form action="/listing/toprated">
                <button type="submit" style="all: unset; cursor: pointer;">
                    <div><i class="fa-solid fa-star"></i></div>

                    <p>Top Rated</p>
                </button>
            </form>

        </div>

        <div class="filter mt-3">
            <form action="/listing/filter" method="get">
                <button type="submit" name="q" value="Hotel" style="all: unset; cursor: pointer;">
                <div><i class="fa-solid fa-hotel"></i></div>

                <p>Hotel</p>
                </button>
            </form>
        </div>

        <div class="filter mt-3">
            <form action="/listing/filter" method="get">
                <button type="submit" name="q" value="Adventure" style="all: unset; cursor: pointer;">
                <div><i class="fa-solid fa-person-hiking"></i></div>

                <p>Adventure</p>
                </button>
            </form>
        </div>

        <div class="filter mt-3">
            <form action="/listing/filter" method="get">
                <button type="submit" name="q" value="Resort" style="all: unset; cursor: pointer;">
                <div><i class="fa-solid fa-house-chimney"></i></div>

                <p>Resort</p>
                </button>
            </form>
        </div>

        <div class="filter mt-3">
            <form action="/listing/filter" method="get">
                <button type="submit" name="q" value="Beach-Related" style="all: unset; cursor: pointer;">
                <div><i class="fa-solid fa-person-swimming"></i></div>

                <p>Beach Related</p>
                </button>
            </form>
        </div>

        <div class="filter mt-3">
            <form action="/listing/filter" method="get">
                <button type="submit" name="q" value="Restaurant" style="all: unset; cursor: pointer;">
                <div><i class="fa-solid fa-bowl-food"></i></div>

                <p>Restaurant</p>
                </button>
            </form>
        </div>

        <div class="filter mt-3">
            <form action="/listing/filter" method="get">
                <button type="submit" name="q" value="Other" style="all: unset; cursor: pointer;">
                <div><i class="fa-solid fa-star"></i></div>

                <p>Other</p>
                </button>
            </form>
        </div>


        <div class="tax-toggle">
            <div class="form-check-reverse form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="switchCheckDefault">
                <label class="form-check-label" for="switchCheckDefault">Include taxes</label>
            </div>
        </div>
    </div>

    <!-- Listings Grid -->
    <div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3">
        <% for(let listing of allListing) { %>
            <a href="/listing/<%= listing._id %>" class="listing-link">
                <div class="card col listing-card">
                    <img src="<%= listing.image.url %>" class="card-img-top" alt="Listing_image" style="height: 20rem;">
                    <div class="card-img-overlay"></div>
                    <div class="card-body">
                        <p class="card-text">
                            <b>
                                <%= listing.title %>
                            </b>
                            <br>
                            Rs<%= listing.price ? listing.price.toLocaleString("en-PK") : "N/A" %>/night &nbsp;&nbsp;<i
                                    class="tax-info">+18% GST</i>
                        </p>
                    </div>
                </div>
            </a>
            <% } %>
    </div>
    <script>
        let taxSwitch = document.getElementById("switchCheckDefault");
        taxSwitch.addEventListener("click", () => {
            let taxInfo = document.getElementsByClassName('tax-info');
            for (info of taxInfo) {
                info.style.display = taxSwitch.checked ? 'inline' : 'none';
            }
        })
    </script>